<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <!-- <meta name="viewport" content="width=device-width,initial-scale=1"> -->
  <title>SummerLyrical_ver.t0108</title>

  <meta name="theme-color" content="#fffbbd"/>
  <meta name="apple-touch-fullscreen" content="yes" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-title" content="your_title">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="robots" content="noodp ,NOINDEX , NOFOLLOW"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  <link rel="stylesheet" href="/test/reset.css">  
  <link rel="stylesheet" href="/test/style.css">



  <link rel="apple-touch-icon" href="/test/16ly.png" sizes="16x16">
  <link rel="apple-touch-icon" href="/test/20ly.png" sizes="20x20">
  <link rel="apple-touch-icon" href="/test/24ly.png" sizes="24x24">
  <link rel="apple-touch-icon" href="/test/29ly.png" sizes="29x29">
  <link rel="apple-touch-icon" href="/test/32ly.png" sizes="32x32">
  <link rel="apple-touch-icon" href="/test/40ly.png" sizes="40x40">
  <link rel="apple-touch-icon" href="/test/48ly.png" sizes="48x48">
  <link rel="apple-touch-icon" href="/test/50ly.png" sizes="50x50">
  <link rel="apple-touch-icon" href="/test/57ly.png" sizes="57x57">
  <link rel="apple-touch-icon" href="/test/64ly.png" sizes="64x64">	
  <link rel="apple-touch-icon" href="/test/72ly.png" sizes="72x72">
  <link rel="apple-touch-icon" href="/test/114ly.png" sizes="114x114">
  <link rel="apple-touch-icon" href="/test/120ly.png" sizes="120x120">
  <link rel="apple-touch-icon" href="/test/128ly.png" sizes="128x128">
  <link rel="apple-touch-icon" href="/test/144ly.png" sizes="144x144">
  <link rel="apple-touch-icon" href="/test/192ly.png" sizes="192x192">
  <link rel="apple-touch-icon" href="/test/256ly.png" sizes="256x256">
  <link rel="apple-touch-icon" href="/test/512ly.png" sizes="512x512">
      <!-- Add to splash screen for Safari on iOS -->

  
  <link href="/test/screen/iphone5_splash.png" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
  <link href="/test/screen/iphone6_splash.png" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
  <link href="/test/screen/iphoneplus_splash.png" media="(device-width: 621px) and (device-height: 1104px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image" />
  <link href="/test/screen/iphonex_splash.png" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image" />
  <link href="/test/screen/iphonexr_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
  <link href="/test/screen/iphonexsmax_splash.png" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3)" rel="apple-touch-startup-image" />
  <link href="/test/screen/ipad_splash.png" media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
  <link href="/test/screen/ipadpro1_splash.png" media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
  <link href="/test/screen/ipadpro3_splash.png" media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
  <link href="/test/screen/ipadpro2_splash.png" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2)" rel="apple-touch-startup-image" />
    
    


  




  
  <link rel="icon" href="/test/favicon.ico"><!-- 512×512 -->
  <link rel="icon" href="/test/test.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/test/apple-touch-icon.png">

  <link rel="stylesheet" href="/test/assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="/test/assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="/test/assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="/test/assets/parallax/jarallax.css">
  <link rel="stylesheet" href="/test/assets/dropdown/css/style.css">
  <link rel="stylesheet" href="/test/assets/socicon/css/styles.css">
  <link rel="stylesheet" href="/test/assets/theme/css/style.css">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Jost:100,200,300,400,500,600,700,800,900,100i,200i,300i,400i,500i,600i,700i,800i,900i&display=swap"></noscript>
  <link rel="preload" as="style" href="/test/assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="/test/assets/mobirise/css/mbr-additional.css" type="text/css">
  
  





</head>




<body>

  <body>
  
    <section data-bs-version="5.1" class="menu menu1 cid-s48OLK6784" once="menu" id="menu1-h">
      
  
      <nav class="navbar navbar-dropdown navbar-expand-lg">
          <div class="container">
              <div class="navbar-brand">
                  
                  <span class="navbar-caption-wrap"><a class="navbar-caption text-white text-primary display-7" href="index.html">トップページ</a></span>
              </div>
              <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbarSupportedContent" data-bs-target="#navbarSupportedContent" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                  <div class="hamburger">
                      <span></span>
                      <span></span>
                      <span></span>
                      <span></span>
                  </div>
              </button>
              <div class="collapse navbar-collapse" id="navbarSupportedContent">
                  <ul class="navbar-nav nav-dropdown nav-right" data-app-modern-menu="true"><li class="nav-item"><a class="nav-link link text-white text-primary display-7" href="page6.html">画像分類WebApp</a>
                      </li></ul>
                  
                  
              </div>
          </div>
      </nav>
  </section>
  
  <section data-bs-version="5.1" class="header1 cid-s48MCQYojq mbr-fullscreen mbr-parallax-background" id="header1-f">
  
      
  
      <div class="mbr-overlay" style="opacity: 0.2; background-color: rgb(255, 255, 255);"></div>
  
      <div class="align-center container">
          <div class="row justify-content-center">
              <div class="col-12 col-lg-8">
                  <h1 class="mbr-section-title mbr-fonts-style mb-3 display-1"><strong>Color Sample</strong></h1>
                  
                  <p class="mbr-text mbr-fonts-style display-7">果実の評価の参考になりそうな画像を集めました。<br>収穫の時期など、作業の決定は果汁分析、食味調査などと組わせて、総合的に判断してください。</p>
                  <div class="mbr-section-btn mt-3"><a class="btn btn-success display-4" href="/test/assets/files/samplepdf.pdf" target="_blank">samplepdf</a> <a class="btn btn-secondary display-4" href="/test/assets/files/samplepdf2.pdf" target="_blank">samplepdf2</a></div>
              </div>
          </div>
      </div>
  </section>
  
  <section data-bs-version="5.1" class="gallery3 cid-tgls86edeq" id="gallery3-z">
      
      
      <div class="container-fluid">
          <div class="mbr-section-head">
              <h4 class="mbr-section-title mbr-fonts-style align-center mb-0 display-2"><strong>シナノリップのヨードデンプン反応</strong></h4>
              <h5 class="mbr-section-subtitle mbr-fonts-style align-center mb-0 mt-2 display-7">写真下の説明文を読んで</h5>
          </div>
          <div class="row mt-4">
              <div class="item features-image сol-12 col-md-6 col-lg-3">
                  <div class="item-wrapper">
                      <div class="item-img">
                          <img src="/test/assets/images/3.5-58-lip-p8120042-250x250.jpg" alt="Mobirise Website Builder">
                      </div>
                      <div class="item-content">
                          <h5 class="item-title mbr-fonts-style display-7"><strong>指数3.5</strong></h5>
                          
                          <p class="mbr-text mbr-fonts-style mt-3 display-7">デンプンが残っています。（着色しています。）収穫には早すぎます。</p>
                      </div>
                      
                  </div>
              </div>
              <div class="item features-image сol-12 col-md-6 col-lg-3">
                  <div class="item-wrapper">
                      <div class="item-img">
                          <img src="/test/assets/images/3-60-lip-p8200726-250x250.jpg" alt="Mobirise Website Builder">
                      </div>
                      <div class="item-content">
                          <h5 class="item-title mbr-fonts-style display-7"><strong>指数3.0</strong></h5>
                          
                          <p class="mbr-text mbr-fonts-style mt-3 display-7">ややデンプンが残っていますが（着色していますが）、収穫できるかもしれません。食味を確認し、開始してください。</p>
                      </div>
                      
                  </div>
              </div>
              <div class="item features-image сol-12 col-md-6 col-lg-3">
                  <div class="item-wrapper">
                      <div class="item-img">
                          <img src="/test/assets/images/2-86-lip-p8120077-250x250.jpg" alt="Mobirise Website Builder">
                      </div>
                      <div class="item-content">
                          <h5 class="item-title mbr-fonts-style display-7"><strong>指数2.0</strong></h5>
                          
                          <p class="mbr-text mbr-fonts-style mt-3 display-7">あまり着色しなくなりました。デンプンがだいぶ抜けています。収穫遅れに注意してください。</p>
                      </div>
                      
                  </div>
              </div>
              <div class="item features-image сol-12 col-md-6 col-lg-3">
                  <div class="item-wrapper">
                      <div class="item-img">
                          <img src="/test/assets/images/1.5-90-lip-p8200835-250x250.jpg" alt="Mobirise Website Builder" title="">
                      </div>
                      <div class="item-content">
                          <h5 class="item-title mbr-fonts-style display-7"><strong>指数1.5</strong></h5>
                          
                          <p class="mbr-text mbr-fonts-style mt-3 display-7">ほとんど着色せず、だいぶデンプンが抜けているようです。収穫が遅いかもしれません。</p>
                      </div>
                      
                  </div>
              </div>
          </div>
      </div>
  </section>



  
  <script>
    // manifestのlinkタグを生成
    function setManifest(path) {
      const manifest = document.createElement('link');
      manifest.rel = 'manifest';
      manifest.href = path;
      document.head.appendChild(manifest);
    }

    // OSに応じて読み込むmanifestを変更
    var userAgent = navigator.userAgent.toLowerCase();
    if (userAgent.indexOf("iphone") > 0 || userAgent.indexOf("ipad") > 0) {
      setManifest('manifest_ios.json')
    } else {
      setManifest('manifest.json')
    }
    </script>  




  <video id="video" autoplay muted playsinline width="300px" height="300px"></video>

  <canvas id="canvas" height="300px"></canvas>
  <h1>画面の中央に大きく映してください</h1>
  <button type="button" onclick="init()">Start</button>
  <div id="label-container">-</div>
  <button id="download">download</button>
  

  

  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>

  <script>

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('serviceWorker.js').then(reg => {
      console.log('サービスワーカーを登録しました', reg);
      }).catch(err => {
      console.log('登録失敗', err);
      });
    }
  </script>

</body>
</html>


<script type="text/javascript">

  let medias;
  //カメラの設定をmediasに格納、※environmentでリアカメラを設定 user
    medias = {
    audio: false,
    video: {
      facingMode: { exact: "environment" }  
    }}
    //};
  
    //DOMに要素追加
      //カメラ映像を出すvideoタグを取得する
      const video = document.getElementById("video");
      //設定したカメラのセッティングで起動する変数promiseを設定
      const promise = navigator.mediaDevices.getUserMedia(medias);
  
      //カメラの起動許可を確認
      promise.then(successCallback)
          .catch(errorCallback);
      //許可が取れるとコールバックしてvideoタグにカメラ映像を写す
      function successCallback(stream) {
      video.srcObject = stream;
      };
      //取れない場合はエラーメッセージを出す
      function errorCallback(err) {
      alert(err);
      };
  
  //googleのteachablemachineを使用して画像解析をする
  const URL = "./my_model/";
  
  let model, labelContainer, maxPredictions;
  
  // initボタンを押すと画像解析をスタートする、コードの中でawaitを使うためasync functionが必要
  async function init() {
  
    //teachablemachineのモデルURLを読み込む
    const modelURL = URL + "model.json";
    const metadataURL = URL + "metadata.json";
  
    //モデルのイメージを格納する
    model = await tmImage.load(modelURL, metadataURL);
    maxPredictions = model.getTotalClasses();
  
    //結果を出す為のlavelcontainerをDOMに要素追加する
    labelContainer = document.getElementById("label-container");
    labelContainer2 = document.getElementById("label-container2");
  
    window.requestAnimationFrame(loop);
  }
  
    async function loop() {
      //canvasに静止画を入れる
      var canvas =document.getElementById("canvas")
      canvas.getContext("2d").drawImage(video, 0, 0, 300, 300)
  
      document.getElementById("download").onclick = (event) => {
        let canvas = document.getElementById("canvas");
  
        let link = document.createElement("a");
        link.href = canvas.toDataURL("image/png");
        link.download = "test.png";
        link.click();
  }
  
  
      //予測は、画像、ビデオ、またはキャンバスのhtml要素を取り込むことができます
      const prediction = await model.predict(canvas);
  
      if ( prediction[0].probability.toFixed(2)>0) {
        labelContainer.innerHTML = "不明";
          }
  
      if ( prediction[0].probability.toFixed(2)> 0.99) {
        labelContainer.innerHTML = "３～４分";
          }
  
      if ( prediction[1].probability.toFixed(2)>0) {
        labelContainer.innerHTML = "不明";
          }    
    
      if ( prediction[1].probability.toFixed(2)> 0.99) {
        labelContainer.innerHTML = "５～６分";
          }
  
      if ( prediction[2].probability.toFixed(2)>0) {
        labelContainer.innerHTML = "不明";
          }
  
      if ( prediction[2].probability.toFixed(2)> 0.99) {
        labelContainer.innerHTML = "7～8分";
          }
      
      //処理を継続させるためloopをさせる
      window.requestAnimationFrame(loop);
        }
    
  </script>
